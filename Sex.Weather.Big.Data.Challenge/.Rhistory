year=2017))
} else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)}
}
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(z+1)
station.test <- isd_stations_search(lat=US.Cities$lat[z], lon = US.Cities$lng[z])
#find city station
station.id.test <- paste(station$usaf[z],station$wban[z],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
} else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)}
}
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
} else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)}
}
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
} else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)}
}
View(US.Cities)
View(US.Cities)
View(US.Cities)
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)}
}
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)}
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
}
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE) }
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)}
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
}
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
}
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
}
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)}
library("rnoaa")
#Try it out
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017)
#file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
}
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
if(!inherits(station.weather,"Error: Not Found (HTTP 404)")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
}
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
if(!inherits(station.weather,"Error")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
}
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017)
#file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
library(gtrendsR)
install.packages("gtrendsR")
library(gtrendsR)
gtrends.countries<- gtrendsR::countries
write.csv(station.weather, paste(path.data,"gtrends.countries.csv"),
row.names = FALSE)
write.csv(gtrends.countries, paste(path.data,"gtrends.countries.csv"),
row.names = FALSE)
#Import needed dataset
US.Cities <- read.csv("cities.csv", na.strings = "")
####Making a weather dataset for one city#######################################
#Look up city
station.1 <- isd_stations_search(lat=US.Cities$lat[1], lon = US.Cities$lng[1])
$wban
$wban
$wban
#find city station
station.id.1 <- paste(station.1$usaf[1],station.1$wban[1],sep="")
#collect data from station
station.1.weather <- lcd(paste(station.1$usaf[1],station.1$wban[1],sep=""),
year=2017)
#file name
filename <- paste(US.Cities$city[1],US.Cities$state_id[1],sep=".")
#create new dataset
write.csv(station.1.weather, paste(path.data, filename,".csv"),
row.names = FALSE)
#create new dataset
write.csv(station.1.weather, paste(path.data, filename,"city.csv"),
row.names = FALSE)
#create new dataset
write.csv(station.1.weather, paste(path.data, filename,"Birmingham.AL.csv"),
row.names = FALSE)
#Try it out
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017)
#file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
#Try it out
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017)
#file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))
if(!inherits(station.weather,"Error")){
(i+1)
station.test <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id.test <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- try(lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2017))}
else{ #file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
}
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
for(i in 1:nrow(US.Cities)){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2018)
#file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
station.1.weather <- lcd(paste(station.1$usaf[1],station.1$wban[1],sep=""),
year=2017)
#file name
filename <- paste(US.Cities$city[1],US.Cities$state_id[1],sep=".")
#create new dataset
write.csv(station.1.weather, paste(path.data, filename,"Birmingham.AL.csv"),
row.names = FALSE)
for(i in 1:1){
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2018)
#file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
#Look up city
station <- isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#find city station
station.id <- paste(station$usaf[i],station$wban[i],sep="")
#collect data from station
station.weather <- lcd(paste(station$usaf[i],station$wban[i],sep=""),
year=2018)
#file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#create new dataset
write.csv(station.weather, paste(path.data, filename,".csv", sep=""),
row.names = FALSE)
}
isd_stations_search(lat=US.Cities$lat[i], lon = US.Cities$lng[i])
#collect data from station
station.1.weather <- lcd(station.id.1,
year=2017)
#collect data from station
station.1.weather <- lcd(station.id.1, year=2017)
View(station.1.weather)
station.weather <- lcd(station.id, year=2017)
View(station.weather)
#file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
#file name
filename <- paste(US.Cities$city[i],US.Cities$state_id[i],sep=".")
####Turn it into a looop loop lop lp############################################
